import os
import sys
import json
import django

sys.path.append(os.path.join(os.path.dirname(__file__), "fls_frontend"))
sys.path.append("../")
os.environ.setdefault("DJANGO_SETTINGS_MODULE", "fls_frontend.settings")
from django.conf import settings

django.setup()

import api_calls

import team.models as tmodels


def main():
    ingest_schedule()

def ingest_teams():
    teams = api_calls.get_teams()
    teams = json.loads(teams)
    for jteam in teams["teams"]:
        team = tmodels.Team()
        team.id = jteam["id"]
        team.name = jteam["name"]
        team.shortName = jteam["shortName"]
        team.link = jteam["link"]
        team.abbreviation = jteam["abbreviation"]
        team.teamName = jteam["teamName"]
        team.locationName = jteam["locationName"]
        team.firstYearOfPlay = jteam["firstYearOfPlay"]
        team.conference = jteam["conference"]["name"][0]
        team.division = jteam["division"]["name"][0]
        team.officialSiteUrl = jteam["officialSiteUrl"]
        team.active = jteam["active"]

        venue = tmodels.Venue()
        venue.name = jteam["venue"]["name"]
        venue.city = jteam["venue"]["city"]
        venue.timeZone = jteam["venue"]["timeZone"]["id"]
        venue.timeZoneOffset = jteam["venue"]["timeZone"]["offset"]
        venue.save()

        team.venue = venue
        team.save()

def ingest_schedule():
    schedule = api_calls.get_schedule()
    schedule = json.loads(schedule)
    print schedule
	

if __name__ == "__main__":
    main()
